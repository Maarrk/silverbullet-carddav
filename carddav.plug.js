var P=Object.defineProperty;var x=(e,t)=>{for(var n in t)P(e,n,{get:t[n],enumerable:!0})};var d=typeof window>"u"&&typeof globalThis.WebSocketPair>"u";typeof Deno>"u"&&(self.Deno={args:[],build:{arch:"x86_64"},env:{get(){}}});var u=new Map,c=0;function a(e){self.postMessage(e)}d&&(globalThis.syscall=async(e,...t)=>await new Promise((n,o)=>{c++,u.set(c,{resolve:n,reject:o}),a({type:"sys",id:c,name:e,args:t})}));function m(e,t){d&&(self.addEventListener("message",n=>{(async()=>{let o=n.data;switch(o.type){case"inv":{let i=e[o.name];if(!i)throw new Error(`Function not loaded: ${o.name}`);try{let s=await Promise.resolve(i(...o.args||[]));a({type:"invr",id:o.id,result:s})}catch(s){console.error("An exception was thrown as a result of invoking function",o.name,"error:",s),a({type:"invr",id:o.id,error:s.message})}}break;case"sysr":{let i=o.id,s=u.get(i);if(!s)throw Error("Invalid request id");u.delete(i),o.error?s.reject(new Error(o.error)):s.resolve(o.result)}break}})().catch(console.error)}),a({type:"manifest",manifest:t}))}function h(e){let t=atob(e),n=t.length,o=new Uint8Array(n);for(let i=0;i<n;i++)o[i]=t.charCodeAt(i);return o}function p(e){typeof e=="string"&&(e=new TextEncoder().encode(e));let t="",n=e.byteLength;for(let o=0;o<n;o++)t+=String.fromCharCode(e[o]);return btoa(t)}async function v(e,t){if(typeof e!="string"){let n=new Uint8Array(await e.arrayBuffer()),o=n.length>0?p(n):void 0;t={method:e.method,headers:Object.fromEntries(e.headers.entries()),base64Body:o},e=e.url}return syscall("sandboxFetch.fetch",e,t)}globalThis.nativeFetch=globalThis.fetch;function b(){globalThis.fetch=async function(e,t){let n=t&&t.body?p(new Uint8Array(await new Response(t.body).arrayBuffer())):void 0,o=await v(e,t&&{method:t.method,headers:t.headers,base64Body:n});return new Response(o.base64Body?h(o.base64Body):null,{status:o.status,headers:o.headers})}}d&&b();var l={};x(l,{confirm:()=>Q,dispatch:()=>J,downloadFile:()=>N,filterBox:()=>j,flashNotification:()=>$,fold:()=>ee,foldAll:()=>oe,getCurrentPage:()=>w,getCursor:()=>C,getSelection:()=>S,getText:()=>F,getUiOption:()=>X,goHistory:()=>D,hidePanel:()=>q,insertAtCursor:()=>G,insertAtPos:()=>V,moveCursor:()=>z,navigate:()=>U,openCommandPalette:()=>W,openPageNavigator:()=>T,openSearchPanel:()=>ie,openUrl:()=>O,prompt:()=>K,reloadPage:()=>E,reloadSettingsAndCommands:()=>L,reloadUI:()=>B,replaceRange:()=>_,save:()=>R,setPage:()=>A,setSelection:()=>k,setText:()=>M,setUiOption:()=>Y,showPanel:()=>H,toggleFold:()=>re,unfold:()=>te,unfoldAll:()=>ne,uploadFile:()=>I,vimEx:()=>Z});typeof self>"u"&&(self={syscall:()=>{throw new Error("Not implemented here")}});var r=self.syscall;function w(){return r("editor.getCurrentPage")}function A(e){return r("editor.setPage",e)}function F(){return r("editor.getText")}function M(e){return r("editor.setText",e)}function C(){return r("editor.getCursor")}function S(){return r("editor.getSelection")}function k(e,t){return r("editor.setSelection",e,t)}function R(){return r("editor.save")}function U(e,t=!1,n=!1){return r("editor.navigate",e,t,n)}function T(e="page"){return r("editor.openPageNavigator",e)}function W(){return r("editor.openCommandPalette")}function E(){return r("editor.reloadPage")}function B(){return r("editor.reloadUI")}function L(){return r("editor.reloadSettingsAndCommands")}function O(e,t=!1){return r("editor.openUrl",e,t)}function D(e){return r("editor.goHistory",e)}function N(e,t){return r("editor.downloadFile",e,t)}function I(e,t){return r("editor.uploadFile",e,t)}function $(e,t="info"){return r("editor.flashNotification",e,t)}function j(e,t,n="",o=""){return r("editor.filterBox",e,t,n,o)}function H(e,t,n,o=""){return r("editor.showPanel",e,t,n,o)}function q(e){return r("editor.hidePanel",e)}function V(e,t){return r("editor.insertAtPos",e,t)}function _(e,t,n){return r("editor.replaceRange",e,t,n)}function z(e,t=!1){return r("editor.moveCursor",e,t)}function G(e){return r("editor.insertAtCursor",e)}function J(e){return r("editor.dispatch",e)}function K(e,t=""){return r("editor.prompt",e,t)}function Q(e){return r("editor.confirm",e)}function X(e){return r("editor.getUiOption",e)}function Y(e,t){return r("editor.setUiOption",e,t)}function Z(e){return r("editor.vimEx",e)}function ee(){return r("editor.fold")}function te(){return r("editor.unfold")}function re(){return r("editor.toggleFold")}function oe(){return r("editor.foldAll")}function ne(){return r("editor.unfoldAll")}function ie(){return r("editor.openSearchPanel")}async function f(){await l.flashNotification("Hello from CardDAV Plug!")}var g={helloWorld:f},y={name:"carddav",functions:{helloWorld:{path:"carddav.ts:helloWorld",command:{name:"CardDAV: Say hello"}}},assets:{}},Ee={manifest:y,functionMapping:g};m(g,y);export{Ee as plug};
